{
  "title": "前端自动化CI/CD：Github Action部署项目到服务器",
  "author": "heavenmei",
  "url": "/2023-12-11-CICD",
  "date": "2023-12-11T00:00:00.000Z",
  "body": {
    "raw": "> **What‘s Github Action？**  \n> [GitHub Actions](https://github.com/features/actions) 是 GitHub 的持续集成服务(CI/CD)。\n> 想要了解的朋友移步 [GitHub Actions 入门教程](https://link.juejin.cn/?target=https%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2019%2F09%2Fgetting-started-with-github-actions.html \"https://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html\")\n\n\n### 编写workflow\n创建`.github/workflows` 文件夹，创建`demo.yml`文件\n\n主要流程：\n1. 拉取main分支的最新代码\n2. 设置node版本号\n3. 缓存依赖\n4. 安装依赖\n5. 打包\n6. 上传资源到指定路径\n\n```yaml\nname: Node CI\n\n# 触发workflow的条件\non:\n\tpush:\n\t\tbranches: [ \"main\" ]\n\tpull_request:\n\t\tbranches: [ \"main\" ]\n\n# jobs表示执行的一项或多项任务\njobs:\n\t# 任务的job_id，具体名称自定义，这里build代表打包\n\tbuild:\n\t\truns-on: ubuntu-latest\n\t\tstrategy:\n\t\t\tmatrix:\n\t\t\t\tnode-version: [18.18.2]\n\n\t\tsteps:\n\t\t\t  # 拉取main分支最新代码\n\t\t\t  uses: actions/checkout@main\n\t\t\t  \n\t\t\t  # 确定node版本\n\t\t\t- name: Use Node.js ${{ matrix.node-version }}\n\t\t\t  uses: actions/setup-node@v3\n\t\t\t  with:\n\t\t\t\tnode-version: ${{ matrix.node-version }}\n\t\t\n\t\t\t # 缓存依赖\n\t\t\t- name: Cache nodemodules\n\t\t\t  uses: actions/cache@v1\n\t\t\t  env:\n\t\t\t\tcache-name: cache-node-modules\n\t\t\t  with:\n\t\t\t    # 需要缓存的文件的路径\n\t\t\t\tpath: ./node_modules \n\t\t\t\t# 对缓存的文件指定的唯一标识\n\t\t\t\tkey: ${{ runner.os }}-build-${{ env.cache-name }}-${{ hashFiles('./package.json') }} \n\t\t\t\t# 用于没有再找目标key的缓存的backup选项\n\t\t\t\trestore-keys: |\n\t\t\t\t\t${{ runner.os }}-build-${{ env.cache-name }}-\n\t\t\t\t\t${{ runner.os }}-build-\n\t\t\t\t\t${{ runner.os }}-\n\t\t\n\t\t\t# 装依赖\n\t\t\t- name: Install\n\t\t\t  run: |\n\t\t\t\tnpm install -g yarn@1.22.19\n\t\t\t\tyarn install\n```\n\n\n### 打包\n本地开发时会把所需要的环境编写在.env 文件内，并且不会上传到github上以保证仓库隐私性。因此，在打包时若有相关生产环境变量，可以直接定义在 secret中\n\n\n在脚本中引用\n```yaml\n\nenv:\n\tVITE_SERVER_NAME: ${{ secrets.VITE_SERVER_NAME }} # 服务器域名\n\tcache-name: note\n\njobs:\n\tbuild:\n\t\tsteps:\n\t\t\t...\n\t\t\t# 打包\n\t\t\t- name: Build\n\t\t\trun: |\n\t\t\t\techo \"VITE_SERVER_NAME = ${{ env.VITE_SERVER_NAME }}\" > .env\n\t\t\t\tyarn build\n\n```\n\n### 部署\n部署思想：首先利用ssh 将打包好的资源上传到服务器上，服务器上利用pm2 管理node进程，nginx反向代理端口，脚本重启pm2该项目进程。\n\n1. 在服务器配置nginx指向前端运行的端口\n```shell\nserver {\n\tlisten 8889;  # 对外接口\n\tserver_name api.msg.com;\n\t\n\tlocation / {\n\t\tproxy_pass http://localhost:3008; # 服务器本地运行前端端口\n\t\tadd_header backendIP $upstream_addr;\n\t\tadd_header backendCode $upstream_status;\n\t}\n}\n```\n2. 服务器创建秘钥对\n将本机与服务器创建密钥对，并把本地公钥加入`.ssh/authorized_keys`中，同时保存到github secrets。\n```yaml\n\nenv:\n\tSERVER_PRIVATE_KEY: ${{ secrets.SERVER_PRIVATE_KEY }} # 服务器私钥\n\tSERVER_HOST: ${{ secrets.SERVER_HOST }} # 服务器IP地址\n\tUSER_NAME: ${{ secrets.USER_NAME }} # 服务器用户名\n\njobs:\n\tbuild:\n\t\tsteps:\n\t\t\t...\n\t\t\t# 上传打包资源\n\t\t\t- name: Deploy\n\t\t\tuses: easingthemes/ssh-deploy@v3\n\t\t\tenv:\n\t\t\t\tSSH_PRIVATE_KEY: ${{ env.SERVER_PRIVATE_KEY }}\n\t\t\t\tARGS: '-avz --delete'\n\t\t\t\tSOURCE: '.output/' # \n\t\t\t\t\n\t\t\t\tREMOTE_HOST: ${{ env.SERVER_HOST }}\n\t\t\t\tREMOTE_USER: ${{ env.USER_NAME }}\n\t\t\t\tTARGET: /root/i-lion-front/.output # 服务器目标路径\n```\n\n3. 重新部署脚本\n首先在服务器中安装[pm2](https://pm2.keymetrics.io/)并启动运行该项目，服务器中创建重启脚本`run_node.sh`\n```shell\npm2 reload xxx/ecosystem.config.cjs\n```\naction 执行该脚本\n```yaml\n# 重新部署\n\n- name: Reload pm2\n  uses: appleboy/ssh-action@master\n  with:\n\thost: ${{ env.SERVER_HOST }}\n\tusername: ${{ env.USER_NAME }}\n\tkey: ${{ env.SERVER_PRIVATE_KEY }}\n\tscript: |\n\t\t# 在服务器中执行的命令\n\t\tzsh xxxrun_node.sh\n```\n\n\n### 执行\n GitHub Actions 绑定`.github/workflows/demo.yml` ，执行结果如下：\n\n### 完整代码\n\n```yaml\nname: Node CI\n\n# 触发workflow的条件\non:\n  push:\n    branches: [ \"main\" ]\n  pull_request:\n    branches: [ \"main\" ]\n\nenv:\n    SERVER_PRIVATE_KEY: ${{ secrets.SERVER_PRIVATE_KEY }} # 服务器私钥\n    SERVER_HOST: ${{ secrets.SERVER_HOST }} # 服务器IP地址\n    USER_NAME: ${{ secrets.USER_NAME }} # 服务器用户名\n    VITE_SERVER_NAME: ${{ secrets.VITE_SERVER_NAME }} \n    cache-name: note\n    \njobs:\n  build:\n\n    runs-on: ubuntu-latest\n\n    strategy:\n      matrix:\n        node-version: [18.18.2]\n        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/\n\n    steps:\n    - uses: actions/checkout@main\n    - name: Use Node.js ${{ matrix.node-version }}\n      uses: actions/setup-node@v3\n      with:\n        node-version: ${{ matrix.node-version }}\n     #缓存依赖\n    - name: Cache nodemodules\n      uses: actions/cache@v1\n      env:\n          cache-name: cache-node-modules\n      with:\n          # 需要缓存的文件的路径\n          path: ./node_modules \n          # 对缓存的文件指定的唯一标识\n          key: ${{ runner.os }}-build-${{ env.cache-name }}-${{ hashFiles('./package.json') }} \n          # 用于没有再找目标key的缓存的backup选项\n          restore-keys: |\n              ${{ runner.os }}-build-${{ env.cache-name }}-\n              ${{ runner.os }}-build-\n              ${{ runner.os }}-\n    # 装依赖\n    - name: Install\n      run: |\n          npm install -g yarn@1.22.19\n          yarn install\n    # 打包\n    - name: Build\n      run: |\n          echo \"VITE_SERVER_NAME = ${{ env.VITE_SERVER_NAME }}\" > .env\n          yarn build\n    # 上传打包资源\n    - name: Deploy\n      uses: easingthemes/ssh-deploy@v3\n      env:\n          SSH_PRIVATE_KEY: ${{ env.SERVER_PRIVATE_KEY }}\n          ARGS: '-avz --delete'\n          SOURCE: '.output/'\n          REMOTE_HOST: ${{ env.SERVER_HOST }}\n          REMOTE_USER: ${{ env.USER_NAME }}\n          TARGET: /root/i-lion-front/.output # 服务器目标路径\n    # 重新部署\n    - name: Reload pm2\n      uses: appleboy/ssh-action@master\n      with:\n        host: ${{ env.SERVER_HOST }}\n        username: ${{ env.USER_NAME }}\n        key: ${{ env.SERVER_PRIVATE_KEY }}\n        script: |\n          source /www/server/nvm/nvm.sh\n          nvm use 18.18.2\n          zsh /root/i-lion-front/run_node.sh\n\n```",
    "code": "var Component=(()=>{var E=Object.create;var r=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var p=Object.getOwnPropertyNames;var y=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var F=(l,n)=>()=>(n||l((n={exports:{}}).exports,n),n.exports),m=(l,n)=>{for(var a in n)r(l,a,{get:n[a],enumerable:!0})},c=(l,n,a,t)=>{if(n&&typeof n==\"object\"||typeof n==\"function\")for(let s of p(n))!u.call(l,s)&&s!==a&&r(l,s,{get:()=>n[s],enumerable:!(t=h(n,s))||t.enumerable});return l};var R=(l,n,a)=>(a=l!=null?E(y(l)):{},c(n||!l||!l.__esModule?r(a,\"default\",{value:l,enumerable:!0}):a,l)),D=l=>c(r({},\"__esModule\",{value:!0}),l);var i=F((v,o)=>{o.exports=_jsx_runtime});var b={};m(b,{default:()=>g,frontmatter:()=>_});var e=R(i()),_={title:\"\\u524D\\u7AEF\\u81EA\\u52A8\\u5316CI/CD\\uFF1AGithub Action\\u90E8\\u7F72\\u9879\\u76EE\\u5230\\u670D\\u52A1\\u5668\",date:new Date(17022528e5),author:\"heavenmei\",categories:[\"Post\"],url:\"/2023-12-11-CICD\"};function d(l){let n=Object.assign({blockquote:\"blockquote\",p:\"p\",strong:\"strong\",br:\"br\",a:\"a\",h3:\"h3\",span:\"span\",code:\"code\",ol:\"ol\",li:\"li\",div:\"div\",figure:\"figure\",pre:\"pre\"},l.components);return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(n.blockquote,{children:[`\n`,(0,e.jsxs)(n.p,{children:[(0,e.jsx)(n.strong,{children:\"What\\u2018s Github Action\\uFF1F\"}),(0,e.jsx)(n.br,{}),`\n`,(0,e.jsx)(n.a,{href:\"https://github.com/features/actions\",children:\"GitHub Actions\"}),`\\xA0\\u662F GitHub \\u7684\\u6301\\u7EED\\u96C6\\u6210\\u670D\\u52A1(CI/CD)\\u3002\n\\u60F3\\u8981\\u4E86\\u89E3\\u7684\\u670B\\u53CB\\u79FB\\u6B65 `,(0,e.jsx)(n.a,{href:\"https://link.juejin.cn/?target=https%3A%2F%2Fwww.ruanyifeng.com%2Fblog%2F2019%2F09%2Fgetting-started-with-github-actions.html\",title:\"https://www.ruanyifeng.com/blog/2019/09/getting-started-with-github-actions.html\",children:\"GitHub Actions \\u5165\\u95E8\\u6559\\u7A0B\"})]}),`\n`]}),`\n`,(0,e.jsxs)(n.h3,{id:\"\\u7F16\\u5199workflow\",children:[(0,e.jsx)(n.a,{className:\"header-anchor\",href:\"#\\u7F16\\u5199workflow\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u7F16\\u5199workflow\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"\\u521B\\u5EFA\",(0,e.jsx)(n.code,{children:\".github/workflows\"}),\" \\u6587\\u4EF6\\u5939\\uFF0C\\u521B\\u5EFA\",(0,e.jsx)(n.code,{children:\"demo.yml\"}),\"\\u6587\\u4EF6\"]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u4E3B\\u8981\\u6D41\\u7A0B\\uFF1A\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u62C9\\u53D6main\\u5206\\u652F\\u7684\\u6700\\u65B0\\u4EE3\\u7801\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u8BBE\\u7F6Enode\\u7248\\u672C\\u53F7\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u7F13\\u5B58\\u4F9D\\u8D56\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u5B89\\u88C5\\u4F9D\\u8D56\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u6253\\u5305\"}),`\n`,(0,e.jsx)(n.li,{children:\"\\u4E0A\\u4F20\\u8D44\\u6E90\\u5230\\u6307\\u5B9A\\u8DEF\\u5F84\"}),`\n`]}),`\n`,(0,e.jsx)(n.div,{className:\"remark-code-container\",children:(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"yaml\",\"data-theme\":\"github-dark\",raw:`name: Node CI\n\n# \\u89E6\\u53D1workflow\\u7684\\u6761\\u4EF6\non:\n\tpush:\n\t\tbranches: [ \"main\" ]\n\tpull_request:\n\t\tbranches: [ \"main\" ]\n\n# jobs\\u8868\\u793A\\u6267\\u884C\\u7684\\u4E00\\u9879\\u6216\\u591A\\u9879\\u4EFB\\u52A1\njobs:\n\t# \\u4EFB\\u52A1\\u7684job_id\\uFF0C\\u5177\\u4F53\\u540D\\u79F0\\u81EA\\u5B9A\\u4E49\\uFF0C\\u8FD9\\u91CCbuild\\u4EE3\\u8868\\u6253\\u5305\n\tbuild:\n\t\truns-on: ubuntu-latest\n\t\tstrategy:\n\t\t\tmatrix:\n\t\t\t\tnode-version: [18.18.2]\n\n\t\tsteps:\n\t\t\t  # \\u62C9\\u53D6main\\u5206\\u652F\\u6700\\u65B0\\u4EE3\\u7801\n\t\t\t  uses: actions/checkout@main\n\t\t\t  \n\t\t\t  # \\u786E\\u5B9Anode\\u7248\\u672C\n\t\t\t- name: Use Node.js \\${{ matrix.node-version }}\n\t\t\t  uses: actions/setup-node@v3\n\t\t\t  with:\n\t\t\t\tnode-version: \\${{ matrix.node-version }}\n\t\t\n\t\t\t # \\u7F13\\u5B58\\u4F9D\\u8D56\n\t\t\t- name: Cache nodemodules\n\t\t\t  uses: actions/cache@v1\n\t\t\t  env:\n\t\t\t\tcache-name: cache-node-modules\n\t\t\t  with:\n\t\t\t    # \\u9700\\u8981\\u7F13\\u5B58\\u7684\\u6587\\u4EF6\\u7684\\u8DEF\\u5F84\n\t\t\t\tpath: ./node_modules \n\t\t\t\t# \\u5BF9\\u7F13\\u5B58\\u7684\\u6587\\u4EF6\\u6307\\u5B9A\\u7684\\u552F\\u4E00\\u6807\\u8BC6\n\t\t\t\tkey: \\${{ runner.os }}-build-\\${{ env.cache-name }}-\\${{ hashFiles('./package.json') }} \n\t\t\t\t# \\u7528\\u4E8E\\u6CA1\\u6709\\u518D\\u627E\\u76EE\\u6807key\\u7684\\u7F13\\u5B58\\u7684backup\\u9009\\u9879\n\t\t\t\trestore-keys: |\n\t\t\t\t\t\\${{ runner.os }}-build-\\${{ env.cache-name }}-\n\t\t\t\t\t\\${{ runner.os }}-build-\n\t\t\t\t\t\\${{ runner.os }}-\n\t\t\n\t\t\t# \\u88C5\\u4F9D\\u8D56\n\t\t\t- name: Install\n\t\t\t  run: |\n\t\t\t\tnpm install -g yarn@1.22.19\n\t\t\t\tyarn install\n`,children:(0,e.jsxs)(n.code,{\"data-language\":\"yaml\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Node CI\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# \\u89E6\\u53D1workflow\\u7684\\u6761\\u4EF6\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"on\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tpush\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\tbranches\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": [ \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"main\"'}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" ]\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tpull_request\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\tbranches\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": [ \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"main\"'}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" ]\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# jobs\\u8868\\u793A\\u6267\\u884C\\u7684\\u4E00\\u9879\\u6216\\u591A\\u9879\\u4EFB\\u52A1\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"jobs\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"\t# \\u4EFB\\u52A1\\u7684job_id\\uFF0C\\u5177\\u4F53\\u540D\\u79F0\\u81EA\\u5B9A\\u4E49\\uFF0C\\u8FD9\\u91CCbuild\\u4EE3\\u8868\\u6253\\u5305\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tbuild\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\truns-on\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"ubuntu-latest\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\tstrategy\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\tmatrix\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\tnode-version\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": [\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"18.18.2\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"]\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\tsteps\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"\t\t\t  # \\u62C9\\u53D6main\\u5206\\u652F\\u6700\\u65B0\\u4EE3\\u7801\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t  uses\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"actions/checkout@main\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"\t\t\t  \"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"\t\t\t  # \\u786E\\u5B9Anode\\u7248\\u672C\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"\t\t\t- \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Use Node.js ${{ matrix.node-version }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t  uses\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"actions/setup-node@v3\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t  with\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\tnode-version\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ matrix.node-version }}\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"\t\t\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"\t\t\t # \\u7F13\\u5B58\\u4F9D\\u8D56\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"\t\t\t- \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Cache nodemodules\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t  uses\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"actions/cache@v1\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t  env\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\tcache-name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"cache-node-modules\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t  with\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"\t\t\t    # \\u9700\\u8981\\u7F13\\u5B58\\u7684\\u6587\\u4EF6\\u7684\\u8DEF\\u5F84\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\tpath\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"./node_modules\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" \"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"\t\t\t\t# \\u5BF9\\u7F13\\u5B58\\u7684\\u6587\\u4EF6\\u6307\\u5B9A\\u7684\\u552F\\u4E00\\u6807\\u8BC6\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\tkey\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ runner.os }}-build-${{ env.cache-name }}-${{ hashFiles('./package.json') }}\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" \"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"\t\t\t\t# \\u7528\\u4E8E\\u6CA1\\u6709\\u518D\\u627E\\u76EE\\u6807key\\u7684\\u7F13\\u5B58\\u7684backup\\u9009\\u9879\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\trestore-keys\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"|\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"\t\t\t\t\t${{ runner.os }}-build-${{ env.cache-name }}-\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"\t\t\t\t\t${{ runner.os }}-build-\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"\t\t\t\t\t${{ runner.os }}-\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"\t\t\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"\t\t\t# \\u88C5\\u4F9D\\u8D56\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"\t\t\t- \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Install\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t  run\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"|\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"\t\t\t\tnpm install -g yarn@1.22.19\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"\t\t\t\tyarn install\"})})]})})})}),`\n`,(0,e.jsxs)(n.h3,{id:\"\\u6253\\u5305\",children:[(0,e.jsx)(n.a,{className:\"header-anchor\",href:\"#\\u6253\\u5305\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u6253\\u5305\"]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u672C\\u5730\\u5F00\\u53D1\\u65F6\\u4F1A\\u628A\\u6240\\u9700\\u8981\\u7684\\u73AF\\u5883\\u7F16\\u5199\\u5728.env \\u6587\\u4EF6\\u5185\\uFF0C\\u5E76\\u4E14\\u4E0D\\u4F1A\\u4E0A\\u4F20\\u5230github\\u4E0A\\u4EE5\\u4FDD\\u8BC1\\u4ED3\\u5E93\\u9690\\u79C1\\u6027\\u3002\\u56E0\\u6B64\\uFF0C\\u5728\\u6253\\u5305\\u65F6\\u82E5\\u6709\\u76F8\\u5173\\u751F\\u4EA7\\u73AF\\u5883\\u53D8\\u91CF\\uFF0C\\u53EF\\u4EE5\\u76F4\\u63A5\\u5B9A\\u4E49\\u5728 secret\\u4E2D\"}),`\n`,(0,e.jsx)(n.p,{children:\"\\u5728\\u811A\\u672C\\u4E2D\\u5F15\\u7528\"}),`\n`,(0,e.jsx)(n.div,{className:\"remark-code-container\",children:(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"yaml\",\"data-theme\":\"github-dark\",raw:`\nenv:\n\tVITE_SERVER_NAME: \\${{ secrets.VITE_SERVER_NAME }} # \\u670D\\u52A1\\u5668\\u57DF\\u540D\n\tcache-name: note\n\njobs:\n\tbuild:\n\t\tsteps:\n\t\t\t...\n\t\t\t# \\u6253\\u5305\n\t\t\t- name: Build\n\t\t\trun: |\n\t\t\t\techo \"VITE_SERVER_NAME = \\${{ env.VITE_SERVER_NAME }}\" > .env\n\t\t\t\tyarn build\n\n`,children:(0,e.jsxs)(n.code,{\"data-language\":\"yaml\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"env\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tVITE_SERVER_NAME\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ secrets.VITE_SERVER_NAME }}\"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\" # \\u670D\\u52A1\\u5668\\u57DF\\u540D\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tcache-name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"note\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"jobs\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tbuild\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\tsteps\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"\t\t\t...\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"\t\t\t# \\u6253\\u5305\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"\t\t\t- \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Build\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\trun\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"|\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\t\t\t\techo \"VITE_SERVER_NAME = ${{ env.VITE_SERVER_NAME }}\" > .env'})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"\t\t\t\tyarn build\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"})]})})})}),`\n`,(0,e.jsxs)(n.h3,{id:\"\\u90E8\\u7F72\",children:[(0,e.jsx)(n.a,{className:\"header-anchor\",href:\"#\\u90E8\\u7F72\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u90E8\\u7F72\"]}),`\n`,(0,e.jsx)(n.p,{children:\"\\u90E8\\u7F72\\u601D\\u60F3\\uFF1A\\u9996\\u5148\\u5229\\u7528ssh \\u5C06\\u6253\\u5305\\u597D\\u7684\\u8D44\\u6E90\\u4E0A\\u4F20\\u5230\\u670D\\u52A1\\u5668\\u4E0A\\uFF0C\\u670D\\u52A1\\u5668\\u4E0A\\u5229\\u7528pm2 \\u7BA1\\u7406node\\u8FDB\\u7A0B\\uFF0Cnginx\\u53CD\\u5411\\u4EE3\\u7406\\u7AEF\\u53E3\\uFF0C\\u811A\\u672C\\u91CD\\u542Fpm2\\u8BE5\\u9879\\u76EE\\u8FDB\\u7A0B\\u3002\"}),`\n`,(0,e.jsxs)(n.ol,{children:[`\n`,(0,e.jsx)(n.li,{children:\"\\u5728\\u670D\\u52A1\\u5668\\u914D\\u7F6Enginx\\u6307\\u5411\\u524D\\u7AEF\\u8FD0\\u884C\\u7684\\u7AEF\\u53E3\"}),`\n`]}),`\n`,(0,e.jsx)(n.div,{className:\"remark-code-container\",children:(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"shell\",\"data-theme\":\"github-dark\",raw:`server {\n\tlisten 8889;  # \\u5BF9\\u5916\\u63A5\\u53E3\n\tserver_name api.msg.com;\n\t\n\tlocation / {\n\t\tproxy_pass http://localhost:3008; # \\u670D\\u52A1\\u5668\\u672C\\u5730\\u8FD0\\u884C\\u524D\\u7AEF\\u7AEF\\u53E3\n\t\tadd_header backendIP $upstream_addr;\n\t\tadd_header backendCode $upstream_status;\n\t}\n}\n`,children:(0,e.jsxs)(n.code,{\"data-language\":\"shell\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"server\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"\tlisten\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\" 8889\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";  \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# \\u5BF9\\u5916\\u63A5\\u53E3\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"\tserver_name\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" api.msg.com\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\";\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"\t\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"\tlocation\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" /\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" {\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"\t\tproxy_pass\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" http://localhost:3008\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"; \"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# \\u670D\\u52A1\\u5668\\u672C\\u5730\\u8FD0\\u884C\\u524D\\u7AEF\\u7AEF\\u53E3\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"\t\tadd_header\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" backendIP\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" $upstream_addr;\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"\t\tadd_header\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" backendCode\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" $upstream_status;\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"\t}\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"}\"})})]})})})}),`\n`,(0,e.jsxs)(n.ol,{start:\"2\",children:[`\n`,(0,e.jsxs)(n.li,{children:[`\\u670D\\u52A1\\u5668\\u521B\\u5EFA\\u79D8\\u94A5\\u5BF9\n\\u5C06\\u672C\\u673A\\u4E0E\\u670D\\u52A1\\u5668\\u521B\\u5EFA\\u5BC6\\u94A5\\u5BF9\\uFF0C\\u5E76\\u628A\\u672C\\u5730\\u516C\\u94A5\\u52A0\\u5165`,(0,e.jsx)(n.code,{children:\".ssh/authorized_keys\"}),\"\\u4E2D\\uFF0C\\u540C\\u65F6\\u4FDD\\u5B58\\u5230github secrets\\u3002\"]}),`\n`]}),`\n`,(0,e.jsx)(n.div,{className:\"remark-code-container\",children:(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"yaml\",\"data-theme\":\"github-dark\",raw:`\nenv:\n\tSERVER_PRIVATE_KEY: \\${{ secrets.SERVER_PRIVATE_KEY }} # \\u670D\\u52A1\\u5668\\u79C1\\u94A5\n\tSERVER_HOST: \\${{ secrets.SERVER_HOST }} # \\u670D\\u52A1\\u5668IP\\u5730\\u5740\n\tUSER_NAME: \\${{ secrets.USER_NAME }} # \\u670D\\u52A1\\u5668\\u7528\\u6237\\u540D\n\njobs:\n\tbuild:\n\t\tsteps:\n\t\t\t...\n\t\t\t# \\u4E0A\\u4F20\\u6253\\u5305\\u8D44\\u6E90\n\t\t\t- name: Deploy\n\t\t\tuses: easingthemes/ssh-deploy@v3\n\t\t\tenv:\n\t\t\t\tSSH_PRIVATE_KEY: \\${{ env.SERVER_PRIVATE_KEY }}\n\t\t\t\tARGS: '-avz --delete'\n\t\t\t\tSOURCE: '.output/' # \n\t\t\t\t\n\t\t\t\tREMOTE_HOST: \\${{ env.SERVER_HOST }}\n\t\t\t\tREMOTE_USER: \\${{ env.USER_NAME }}\n\t\t\t\tTARGET: /root/i-lion-front/.output # \\u670D\\u52A1\\u5668\\u76EE\\u6807\\u8DEF\\u5F84\n`,children:(0,e.jsxs)(n.code,{\"data-language\":\"yaml\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"env\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tSERVER_PRIVATE_KEY\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ secrets.SERVER_PRIVATE_KEY }}\"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\" # \\u670D\\u52A1\\u5668\\u79C1\\u94A5\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tSERVER_HOST\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ secrets.SERVER_HOST }}\"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\" # \\u670D\\u52A1\\u5668IP\\u5730\\u5740\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tUSER_NAME\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ secrets.USER_NAME }}\"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\" # \\u670D\\u52A1\\u5668\\u7528\\u6237\\u540D\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"jobs\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tbuild\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\tsteps\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"\t\t\t...\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"\t\t\t# \\u4E0A\\u4F20\\u6253\\u5305\\u8D44\\u6E90\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"\t\t\t- \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Deploy\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\tuses\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"easingthemes/ssh-deploy@v3\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\tenv\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\tSSH_PRIVATE_KEY\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.SERVER_PRIVATE_KEY }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\tARGS\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'-avz --delete'\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\tSOURCE\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'.output/'\"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\" # \"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"\t\t\t\t\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\tREMOTE_HOST\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.SERVER_HOST }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\tREMOTE_USER\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.USER_NAME }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\t\t\t\tTARGET\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"/root/i-lion-front/.output\"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\" # \\u670D\\u52A1\\u5668\\u76EE\\u6807\\u8DEF\\u5F84\"})]})]})})})}),`\n`,(0,e.jsxs)(n.ol,{start:\"3\",children:[`\n`,(0,e.jsxs)(n.li,{children:[`\\u91CD\\u65B0\\u90E8\\u7F72\\u811A\\u672C\n\\u9996\\u5148\\u5728\\u670D\\u52A1\\u5668\\u4E2D\\u5B89\\u88C5`,(0,e.jsx)(n.a,{href:\"https://pm2.keymetrics.io/\",children:\"pm2\"}),\"\\u5E76\\u542F\\u52A8\\u8FD0\\u884C\\u8BE5\\u9879\\u76EE\\uFF0C\\u670D\\u52A1\\u5668\\u4E2D\\u521B\\u5EFA\\u91CD\\u542F\\u811A\\u672C\",(0,e.jsx)(n.code,{children:\"run_node.sh\"})]}),`\n`]}),`\n`,(0,e.jsx)(n.div,{className:\"remark-code-container\",children:(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"shell\",\"data-theme\":\"github-dark\",raw:`pm2 reload xxx/ecosystem.config.cjs\n`,children:(0,e.jsx)(n.code,{\"data-language\":\"shell\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#B392F0\"},children:\"pm2\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" reload\"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\" xxx/ecosystem.config.cjs\"})]})})})})}),`\n`,(0,e.jsx)(n.p,{children:\"action \\u6267\\u884C\\u8BE5\\u811A\\u672C\"}),`\n`,(0,e.jsx)(n.div,{className:\"remark-code-container\",children:(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"yaml\",\"data-theme\":\"github-dark\",raw:`# \\u91CD\\u65B0\\u90E8\\u7F72\n\n- name: Reload pm2\n  uses: appleboy/ssh-action@master\n  with:\n\thost: \\${{ env.SERVER_HOST }}\n\tusername: \\${{ env.USER_NAME }}\n\tkey: \\${{ env.SERVER_PRIVATE_KEY }}\n\tscript: |\n\t\t# \\u5728\\u670D\\u52A1\\u5668\\u4E2D\\u6267\\u884C\\u7684\\u547D\\u4EE4\n\t\tzsh xxxrun_node.sh\n`,children:(0,e.jsxs)(n.code,{\"data-language\":\"yaml\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# \\u91CD\\u65B0\\u90E8\\u7F72\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"- \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Reload pm2\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"  uses\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"appleboy/ssh-action@master\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"  with\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\thost\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.SERVER_HOST }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tusername\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.USER_NAME }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tkey\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.SERVER_PRIVATE_KEY }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"\tscript\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"|\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"\t\t# \\u5728\\u670D\\u52A1\\u5668\\u4E2D\\u6267\\u884C\\u7684\\u547D\\u4EE4\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"\t\tzsh xxxrun_node.sh\"})})]})})})}),`\n`,(0,e.jsxs)(n.h3,{id:\"\\u6267\\u884C\",children:[(0,e.jsx)(n.a,{className:\"header-anchor\",href:\"#\\u6267\\u884C\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u6267\\u884C\"]}),`\n`,(0,e.jsxs)(n.p,{children:[\"GitHub Actions \\u7ED1\\u5B9A\",(0,e.jsx)(n.code,{children:\".github/workflows/demo.yml\"}),\" \\uFF0C\\u6267\\u884C\\u7ED3\\u679C\\u5982\\u4E0B\\uFF1A\"]}),`\n`,(0,e.jsxs)(n.h3,{id:\"\\u5B8C\\u6574\\u4EE3\\u7801\",children:[(0,e.jsx)(n.a,{className:\"header-anchor\",href:\"#\\u5B8C\\u6574\\u4EE3\\u7801\",children:(0,e.jsx)(n.span,{className:\"icon icon-link\"})}),\"\\u5B8C\\u6574\\u4EE3\\u7801\"]}),`\n`,(0,e.jsx)(n.div,{className:\"remark-code-container\",children:(0,e.jsx)(n.figure,{\"data-rehype-pretty-code-figure\":\"\",children:(0,e.jsx)(n.pre,{style:{backgroundColor:\"#24292e\",color:\"#e1e4e8\"},tabIndex:\"0\",\"data-language\":\"yaml\",\"data-theme\":\"github-dark\",raw:`name: Node CI\n\n# \\u89E6\\u53D1workflow\\u7684\\u6761\\u4EF6\non:\n  push:\n    branches: [ \"main\" ]\n  pull_request:\n    branches: [ \"main\" ]\n\nenv:\n    SERVER_PRIVATE_KEY: \\${{ secrets.SERVER_PRIVATE_KEY }} # \\u670D\\u52A1\\u5668\\u79C1\\u94A5\n    SERVER_HOST: \\${{ secrets.SERVER_HOST }} # \\u670D\\u52A1\\u5668IP\\u5730\\u5740\n    USER_NAME: \\${{ secrets.USER_NAME }} # \\u670D\\u52A1\\u5668\\u7528\\u6237\\u540D\n    VITE_SERVER_NAME: \\${{ secrets.VITE_SERVER_NAME }} \n    cache-name: note\n    \njobs:\n  build:\n\n    runs-on: ubuntu-latest\n\n    strategy:\n      matrix:\n        node-version: [18.18.2]\n        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/\n\n    steps:\n    - uses: actions/checkout@main\n    - name: Use Node.js \\${{ matrix.node-version }}\n      uses: actions/setup-node@v3\n      with:\n        node-version: \\${{ matrix.node-version }}\n     #\\u7F13\\u5B58\\u4F9D\\u8D56\n    - name: Cache nodemodules\n      uses: actions/cache@v1\n      env:\n          cache-name: cache-node-modules\n      with:\n          # \\u9700\\u8981\\u7F13\\u5B58\\u7684\\u6587\\u4EF6\\u7684\\u8DEF\\u5F84\n          path: ./node_modules \n          # \\u5BF9\\u7F13\\u5B58\\u7684\\u6587\\u4EF6\\u6307\\u5B9A\\u7684\\u552F\\u4E00\\u6807\\u8BC6\n          key: \\${{ runner.os }}-build-\\${{ env.cache-name }}-\\${{ hashFiles('./package.json') }} \n          # \\u7528\\u4E8E\\u6CA1\\u6709\\u518D\\u627E\\u76EE\\u6807key\\u7684\\u7F13\\u5B58\\u7684backup\\u9009\\u9879\n          restore-keys: |\n              \\${{ runner.os }}-build-\\${{ env.cache-name }}-\n              \\${{ runner.os }}-build-\n              \\${{ runner.os }}-\n    # \\u88C5\\u4F9D\\u8D56\n    - name: Install\n      run: |\n          npm install -g yarn@1.22.19\n          yarn install\n    # \\u6253\\u5305\n    - name: Build\n      run: |\n          echo \"VITE_SERVER_NAME = \\${{ env.VITE_SERVER_NAME }}\" > .env\n          yarn build\n    # \\u4E0A\\u4F20\\u6253\\u5305\\u8D44\\u6E90\n    - name: Deploy\n      uses: easingthemes/ssh-deploy@v3\n      env:\n          SSH_PRIVATE_KEY: \\${{ env.SERVER_PRIVATE_KEY }}\n          ARGS: '-avz --delete'\n          SOURCE: '.output/'\n          REMOTE_HOST: \\${{ env.SERVER_HOST }}\n          REMOTE_USER: \\${{ env.USER_NAME }}\n          TARGET: /root/i-lion-front/.output # \\u670D\\u52A1\\u5668\\u76EE\\u6807\\u8DEF\\u5F84\n    # \\u91CD\\u65B0\\u90E8\\u7F72\n    - name: Reload pm2\n      uses: appleboy/ssh-action@master\n      with:\n        host: \\${{ env.SERVER_HOST }}\n        username: \\${{ env.USER_NAME }}\n        key: \\${{ env.SERVER_PRIVATE_KEY }}\n        script: |\n          source /www/server/nvm/nvm.sh\n          nvm use 18.18.2\n          zsh /root/i-lion-front/run_node.sh\n\n`,children:(0,e.jsxs)(n.code,{\"data-language\":\"yaml\",\"data-theme\":\"github-dark\",style:{display:\"grid\"},children:[(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Node CI\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"# \\u89E6\\u53D1workflow\\u7684\\u6761\\u4EF6\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"on\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"  push\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"    branches\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": [ \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"main\"'}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" ]\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"  pull_request\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"    branches\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": [ \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'\"main\"'}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" ]\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"env\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"    SERVER_PRIVATE_KEY\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ secrets.SERVER_PRIVATE_KEY }}\"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\" # \\u670D\\u52A1\\u5668\\u79C1\\u94A5\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"    SERVER_HOST\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ secrets.SERVER_HOST }}\"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\" # \\u670D\\u52A1\\u5668IP\\u5730\\u5740\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"    USER_NAME\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ secrets.USER_NAME }}\"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\" # \\u670D\\u52A1\\u5668\\u7528\\u6237\\u540D\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"    VITE_SERVER_NAME\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ secrets.VITE_SERVER_NAME }}\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" \"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"    cache-name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"note\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    \"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"jobs\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"  build\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"    runs-on\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"ubuntu-latest\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"    strategy\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      matrix\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"        node-version\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": [\"}),(0,e.jsx)(n.span,{style:{color:\"#79B8FF\"},children:\"18.18.2\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"]\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"    steps\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    - \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"uses\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"actions/checkout@main\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    - \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Use Node.js ${{ matrix.node-version }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      uses\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"actions/setup-node@v3\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      with\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"        node-version\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ matrix.node-version }}\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"     #\\u7F13\\u5B58\\u4F9D\\u8D56\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    - \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Cache nodemodules\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      uses\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"actions/cache@v1\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      env\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"          cache-name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"cache-node-modules\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      with\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"          # \\u9700\\u8981\\u7F13\\u5B58\\u7684\\u6587\\u4EF6\\u7684\\u8DEF\\u5F84\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"          path\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"./node_modules\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" \"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"          # \\u5BF9\\u7F13\\u5B58\\u7684\\u6587\\u4EF6\\u6307\\u5B9A\\u7684\\u552F\\u4E00\\u6807\\u8BC6\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"          key\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ runner.os }}-build-${{ env.cache-name }}-${{ hashFiles('./package.json') }}\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\" \"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"          # \\u7528\\u4E8E\\u6CA1\\u6709\\u518D\\u627E\\u76EE\\u6807key\\u7684\\u7F13\\u5B58\\u7684backup\\u9009\\u9879\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"          restore-keys\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"|\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"              ${{ runner.os }}-build-${{ env.cache-name }}-\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"              ${{ runner.os }}-build-\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"              ${{ runner.os }}-\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # \\u88C5\\u4F9D\\u8D56\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    - \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Install\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      run\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"|\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"          npm install -g yarn@1.22.19\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"          yarn install\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # \\u6253\\u5305\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    - \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Build\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      run\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"|\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:'          echo \"VITE_SERVER_NAME = ${{ env.VITE_SERVER_NAME }}\" > .env'})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"          yarn build\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # \\u4E0A\\u4F20\\u6253\\u5305\\u8D44\\u6E90\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    - \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Deploy\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      uses\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"easingthemes/ssh-deploy@v3\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      env\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"          SSH_PRIVATE_KEY\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.SERVER_PRIVATE_KEY }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"          ARGS\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'-avz --delete'\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"          SOURCE\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"'.output/'\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"          REMOTE_HOST\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.SERVER_HOST }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"          REMOTE_USER\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.USER_NAME }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"          TARGET\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"/root/i-lion-front/.output\"}),(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\" # \\u670D\\u52A1\\u5668\\u76EE\\u6807\\u8DEF\\u5F84\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#6A737D\"},children:\"    # \\u91CD\\u65B0\\u90E8\\u7F72\"})}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\"    - \"}),(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"name\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"Reload pm2\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      uses\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"appleboy/ssh-action@master\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"      with\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\":\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"        host\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.SERVER_HOST }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"        username\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.USER_NAME }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"        key\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"${{ env.SERVER_PRIVATE_KEY }}\"})]}),`\n`,(0,e.jsxs)(n.span,{\"data-line\":\"\",children:[(0,e.jsx)(n.span,{style:{color:\"#85E89D\"},children:\"        script\"}),(0,e.jsx)(n.span,{style:{color:\"#E1E4E8\"},children:\": \"}),(0,e.jsx)(n.span,{style:{color:\"#F97583\"},children:\"|\"})]}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"          source /www/server/nvm/nvm.sh\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"          nvm use 18.18.2\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:(0,e.jsx)(n.span,{style:{color:\"#9ECBFF\"},children:\"          zsh /root/i-lion-front/run_node.sh\"})}),`\n`,(0,e.jsx)(n.span,{\"data-line\":\"\",children:\" \"})]})})})})]})}function C(l={}){let{wrapper:n}=l.components||{};return n?(0,e.jsx)(n,Object.assign({},l,{children:(0,e.jsx)(d,l)})):d(l)}var g=C;return D(b);})();\n;return Component;"
  },
  "_id": "post/2023-12-11-Front-CICD-with-Github-Actions.md",
  "_raw": {
    "sourceFilePath": "post/2023-12-11-Front-CICD-with-Github-Actions.md",
    "sourceFileName": "2023-12-11-Front-CICD-with-Github-Actions.md",
    "sourceFileDir": "post",
    "contentType": "markdown",
    "flattenedPath": "post/2023-12-11-Front-CICD-with-Github-Actions"
  },
  "type": "Post",
  "parDir": "post",
  "slug": "/post/2023-12-11-Front-CICD-with-Github-Actions",
  "slugAsParams": "2023-12-11-Front-CICD-with-Github-Actions"
}